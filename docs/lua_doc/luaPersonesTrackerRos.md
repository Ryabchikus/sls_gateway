DRAFT

План

- если следим и за микротом и за кинетиком, то микрот меняет только значение объекта, а флагом "все дома" управляет сам SLS - он в таком случае тоже чекает объект ежеминутно
- если следим только за микротом, то микрот также управляет и флагом

- TODO - с шлюза забирать JSON
	- сделать JSON.conf на SLS
	- при инициализации шлюз создает объект из файла json.conf через os.fileRead()
	- можно при изменении конфига слать флаг в RB через http.request или дополнительный/временный объект - флаг
- зареганные устройства скопировать в Access List и дать комент вида "DeviceName" - одним словом без пробелов и спецсимволов
- скрипт в RB дергает `/interface wireless registration-table` из шедулера
	- если первый раз, формирует глобальные переменные с устройствами из конфига и их предыдущем статусе в RB (не в SLS)
	- сверяет список зареганых устройств со списком из конфига и их статусом в предыдущей проверке
	- если статус изменился:
		- если в предыдуще проверке не было активных устройств сформировать запрос на изменение объекта SLS и флага "все дома" (ACK в SLS)
		- если список активных изменился и в предыдущей проверке активные были - запрос только на изменение значения объекта
		- если список изменился и активных не стало, то сформировать запрос на изменение объекта SLS и флага "все дома" (ACK в SLS)
		- 



### Persones Tracker для Mikrotik ROS
## Введение


## Настройка mikrotik 

- Поскольку SLS может отслеживать устройства не только на RB, но и на других [роутерах](/lua_doc/luaPersonesTracker.md), хочется иметь единый конфиг для разных маршрутизаторов. Конфиг в свою очередь должен храниться на шлюзе.
- При регистрации Wi-Fi устройства на Mikrotik (далее RB), в `/interface wireless registration-table` ничего интересного, кроме MAC, нет. Поэтому, отслеживаемые устройства добавлем в `/interface wireless access-list` и даём им в коментарии имена, которые разрешено использовать в названиях ключей таблиц LUA. Например:
```
> /interface wireless access-list print terse
0   comment=IPhoneMama ...
1   comment=IPhonePapa ...
```


